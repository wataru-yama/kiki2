# 機材貸出管理システム

このシステムは、企業や現場で使用する機材の貸出状況を管理するためのウェブアプリケーションです。Google Apps Script (GAS) とGoogle Spreadsheetを利用して、データの管理と運用を簡略化しています。

## 主な機能

### 1. 機材マスター管理
- 機材の追加・編集・削除
- 機材の詳細情報（名称、仕様、メーカー、総台数など）の管理

### 2. 現場マスター管理
- 貸出先となる現場の登録・削除

### 3. 置場マスター管理
- 機材の保管場所の登録・削除

### 4. 機材貸出管理
- カレンダー形式（ガントチャート）での機材貸出状況の可視化
- ドラッグによる貸出期間の選択と貸出登録
- 貸出バーのドラッグで貸出日付の移動
- 貸出バーのリサイズで借用開始日・終了日の変更
- 貸出バー上の返却アイコンで返却処理
- 部分返却対応（一部の台数のみ返却可能）

### 5. ユーザー管理
- ログインユーザーの識別と操作記録
- ユーザー権限の管理（管理者、編集者、閲覧者）

### 6. システム設定
- システム名の設定
- フォントサイズの調整（老眼対策）
- カレンダー表示日数の設定

## スクリーンショット

（スクリーンショットをここに配置）

## システム構成

### フロントエンド
- HTML/CSS/JavaScript
- Materialize CSS フレームワーク
- レスポンシブデザイン（PCとモバイル両対応）

### バックエンド
- Google Apps Script (GAS)
- Google Spreadsheet（データベースとして利用）

### データストア（スプレッドシートのシート構成）
- 機器リスト：機材マスター情報
- 貸出履歴：貸出記録
- 現場マスター：貸出先情報
- 置場マスター：機材の保管場所情報
- ユーザーマスター：ユーザー情報
- 機器バックアップ：変更履歴
- システム設定：アプリケーション設定

## 特徴

### ユーザビリティの向上
- PCとモバイルデバイス両方に最適化されたレスポンシブデザイン
- 文字サイズの変更機能で、老眼の方も使いやすい
- タッチ操作の最適化（スワイプ、ドラッグ＆ドロップ）
- 直感的なガントチャート形式での貸出状況表示

### データの整合性
- 貸出時の在庫数チェック機能
- バックアップ機能で変更履歴を記録
- ユーザー権限による操作制限

### 使い勝手
- 単一の画面で主要な機能にアクセス可能
- 操作フローの一貫性
- わかりやすいエラーメッセージとフィードバック

## インストール方法

1. Google Driveにアクセスし、新しいGoogle Spreadsheetを作成します
2. ツール > スクリプトエディタ を選択してスクリプトエディタを開きます
3. 以下のファイルを作成して、それぞれのコードをコピー＆ペーストします：
   - Code.js
   - Index.html
   - Javascript.html
   - stylesheet.html
4. スクリプトエディタでデプロイ > 新しいデプロイ を選択します
5. デプロイタイプとして「ウェブアプリ」を選択します
6. 次のアクセス権を設定します：
   - 次のユーザーとして実行: 自分（あなたのGoogleアカウント）
   - アクセスできるユーザー: 組織内の全員（推奨）または全員
7. デプロイをクリックし、アクセス権を承認します
8. 生成されたウェブアプリのURLでシステムにアクセスできます

## 使用方法

### 初回アクセス
- 初回アクセス時に必要なシートが自動的に作成されます
- 最初のユーザーには自動的に閲覧者権限が付与されます

### 基本的な操作
1. 機材マスター、現場マスター、置場マスターを登録します
2. ガントチャート上でドラッグして貸出期間を選択し、貸出情報を登録します
3. 貸出バーをドラッグまたはリサイズして期間を変更できます
4. 返却は貸出バー上の返却アイコンをクリックして行います

### カレンダーナビゲーション
- 「前へ」「次へ」ボタンで期間を移動
- 「本日」ボタンで現在の日付に戻る
- スワイプ操作でも移動可能（モバイル向け）

### 設定変更
- 画面右上のユーザーアイコンから「システム設定」を開く
- フォントサイズや表示日数を調整可能

## 開発者向け情報

### ファイル構成
- **Code.js**: バックエンドのビジネスロジック
- **Index.html**: メインのHTMLテンプレート
- **Javascript.html**: フロントエンドのJavaScriptコード
- **stylesheet.html**: CSSスタイル定義

### カスタマイズ方法
- スプレッドシートの列構成を変更する場合は、Code.jsの対応する関数も修正する必要があります
- UIデザインの変更はstylesheet.htmlで行います
- 新機能の追加は、Code.jsとJavascript.htmlの両方の変更が必要な場合が多いです

### 注意事項
- 大量のデータを扱う場合、Googleスプレッドシートの制限に注意してください
- サーバー側の処理時間が長い場合、タイムアウトエラーが発生する可能性があります

## ライセンス

MIT License

## 作者・貢献者

（作者情報をここに記載）

## 問い合わせ先

（問い合わせ先情報をここに記載）

## 更新履歴

- v1.0.0 (2025-04-19): 初回リリース
